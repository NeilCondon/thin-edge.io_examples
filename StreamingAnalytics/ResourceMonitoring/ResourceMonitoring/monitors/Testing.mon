monitor Testing {
	
	event Trigger {}
	action onload() {
		spawn testCode();
	}
	
	float counter := 1.0;
	
	action testCode() {
		monitor.subscribe("out");
		on all StatusReport() as status {
			log "Got report at " + status.reportTime.toString() + " : CPU = " + status.cpuPercent.toString() + " , MEM: " + status.memPercent.toString() + " for duration "
			+ status.monitoringDuration.toString();
		}
		
		on all Trigger() {
			send StatusUpdate(currentTime, counter, 30.0) to "in";
			counter := counter + 1.0;
			on wait(1.0) {
				send Trigger() to context.current();
			}
		}
		route Trigger();
		
	}
}