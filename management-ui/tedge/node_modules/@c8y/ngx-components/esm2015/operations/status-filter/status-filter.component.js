import * as tslib_1 from "tslib";
import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { Component, EventEmitter, HostBinding, Input, Output } from '@angular/core';
let StatusFilterComponent = class StatusFilterComponent {
    constructor() {
        this.statusOptions = [];
        this.onFilterChanged = new EventEmitter();
        this.isAllButtonSelected = true;
    }
    /** List of filter options to be displayed */
    set options(options) {
        this.statusOptions = (options || []).map(option => ({ selected: false, option }));
    }
    /**
     * Allows multiple options to be active simultaneosly.
     */
    set _multiple(multiple) {
        this.multiple = coerceBooleanProperty(multiple);
    }
    /** Display the filter as a small button group */
    set _small(small) {
        this.small = coerceBooleanProperty(small);
    }
    get displaySmall() {
        return this.small;
    }
    changeFilter(option) {
        this.isAllButtonSelected = false;
        let emitNeeded = false;
        if (this.multiple) {
            option.selected = !option.selected;
            emitNeeded = true;
        }
        else if (!option.selected) {
            option.selected = true;
            this.statusOptions.filter(op => op !== option).forEach(op => (op.selected = false));
            emitNeeded = true;
        }
        if (emitNeeded) {
            this.emitSelectedOptions();
        }
    }
    removeFilter() {
        this.isAllButtonSelected = true;
        this.statusOptions.forEach(op => (op.selected = false));
        this.emitSelectedOptions();
    }
    /**
     * Allows the filter to be initalliy displayed with some preset filters.
     *
     * @param filters An `IStatusOption` array defining filter options to be preset.
     * @param emit  (optional) If `true` component will emit `onFilterChanged` event.
     */
    preset(filters, emit = true) {
        let firstSelected = false;
        this.statusOptions.forEach(option => (option.selected = false));
        this.statusOptions
            .filter(option => (filters || []).map(o => o.label).includes(option.option.label))
            .filter(() => {
            // only first option passed will be set in single selection mode
            const include = this.multiple || !firstSelected;
            if (include) {
                firstSelected = true;
            }
            return include;
        })
            .forEach(option => (option.selected = true));
        this.isAllButtonSelected = !(filters && filters.length);
        if (emit) {
            this.emitSelectedOptions();
        }
    }
    reset() {
        this.removeFilter();
    }
    activeFilters() {
        return this.statusOptions.filter(option => option.selected).map(option => option.option);
    }
    isFilterApplied() {
        return this.statusOptions.some(option => option.selected);
    }
    emitSelectedOptions() {
        this.onFilterChanged.emit(this.statusOptions.filter(option => option.selected).map(option => option.option));
    }
};
tslib_1.__decorate([
    Input()
], StatusFilterComponent.prototype, "options", null);
tslib_1.__decorate([
    Input('multiple')
], StatusFilterComponent.prototype, "_multiple", null);
tslib_1.__decorate([
    Input('small')
], StatusFilterComponent.prototype, "_small", null);
tslib_1.__decorate([
    HostBinding('class.btn-group-sm')
], StatusFilterComponent.prototype, "displaySmall", null);
tslib_1.__decorate([
    Output()
], StatusFilterComponent.prototype, "onFilterChanged", void 0);
StatusFilterComponent = tslib_1.__decorate([
    Component({
        selector: 'c8y-status-filter',
        template: "<div dropdown \n  placement=\"bottom left\" \n  class=\"dropdown c8y-child-assets-selector\"\n>\n  <button id=\"status-filter\" \n    dropdownToggle \n    type=\"button\" \n    class=\"btn dropdown-toggle d-flex a-i-center c8y-dropdown\"\n    title=\"{{ 'Status filter' | translate}}\"\n    aria-controls=\"dropdown-status-filter\">\n    <span *ngFor=\"let option of statusOptions\" class=\"d-contents\">\n      <span class=\"text-truncate\" *ngIf=\"option.selected\">\n        <i [class]=\"option.option?.iconClass\"></i>\n        <span class=\"m-l-4\">{{ option.option?.label | translate }}</span>\n      </span>\n    </span>\n    <span class=\"text-truncate\" *ngIf=\"isAllButtonSelected\">\n      <i c8yIcon=\"c8y-energy\" class=\"m-r-4 text-info\"></i>\n      {{ 'All statuses' | translate }}\n    </span>\n  </button>\n  <ul id=\"dropdown-status-filter\" \n    *dropdownMenu \n    class=\"dropdown-menu\"\n    role=\"menu\" \n    aria-labelledby=\"status-filter\"\n  >\n    <li *ngFor=\"let option of statusOptions\" [ngClass]=\"{ active: option.selected }\" >\n      <button\n        (click)=\"changeFilter(option)\"\n      >\n        <i [class]=\"option.option?.iconClass\"></i>\n        <span class=\"m-l-4\">{{ option.option?.label | translate }}</span>\n      </button>\n    </li>\n    <li [ngClass]=\"{ active: isAllButtonSelected }\">\n      <button\n        title=\"{{ 'All' | translate }}\"\n        (click)=\"removeFilter()\"\n      >\n        <i c8yIcon=\"c8y-energy\" class=\"m-r-4 text-info\"></i>\n        {{ 'All statuses' | translate }}\n      </button>\n    </li>\n  </ul>\n</div>"
    })
], StatusFilterComponent);
export { StatusFilterComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdHVzLWZpbHRlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYzh5L25neC1jb21wb25lbnRzL29wZXJhdGlvbnMvc3RhdHVzLWZpbHRlci8iLCJzb3VyY2VzIjpbInN0YXR1cy1maWx0ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQU9wRixJQUFhLHFCQUFxQixHQUFsQyxNQUFhLHFCQUFxQjtJQUpsQztRQUtFLGtCQUFhLEdBQXdELEVBQUUsQ0FBQztRQXVCOUQsb0JBQWUsR0FBa0MsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUU5RSx3QkFBbUIsR0FBWSxJQUFJLENBQUM7SUE4RXRDLENBQUM7SUFyR0MsNkNBQTZDO0lBQ3BDLElBQUksT0FBTyxDQUFDLE9BQXdCO1FBQzNDLElBQUksQ0FBQyxhQUFhLEdBQUcsQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3BGLENBQUM7SUFFRDs7T0FFRztJQUNnQixJQUFJLFNBQVMsQ0FBQyxRQUFpQjtRQUNoRCxJQUFJLENBQUMsUUFBUSxHQUFHLHFCQUFxQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRCxpREFBaUQ7SUFDakMsSUFBSSxNQUFNLENBQUMsS0FBYztRQUN2QyxJQUFJLENBQUMsS0FBSyxHQUFHLHFCQUFxQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFa0MsSUFBSSxZQUFZO1FBQ2pELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztJQUNw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LENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBRU8sbUJBQW1CO1FBQ3pCLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUN2QixJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQ2xGLENBQUM7SUFDSixDQUFDO0NBQ0YsQ0FBQTtBQXBHVTtJQUFSLEtBQUssRUFBRTtvREFFUDtBQUtrQjtJQUFsQixLQUFLLENBQUMsVUFBVSxDQUFDO3NEQUVqQjtBQUdlO0lBQWYsS0FBSyxDQUFDLE9BQU8sQ0FBQzttREFFZDtBQUVrQztJQUFsQyxXQUFXLENBQUMsb0JBQW9CLENBQUM7eURBRWpDO0FBRVM7SUFBVCxNQUFNLEVBQUU7OERBQXFFO0FBeEJuRSxxQkFBcUI7SUFKakMsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLG1CQUFtQjtRQUM3Qiwra0RBQTZDO0tBQzlDLENBQUM7R0FDVyxxQkFBcUIsQ0F3R2pDO1NBeEdZLHFCQUFxQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XG5pbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSG9zdEJpbmRpbmcsIElucHV0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IElTdGF0dXNPcHRpb24gfSBmcm9tICcuL3N0YXR1cy1vcHRpb24ubW9kZWwnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktc3RhdHVzLWZpbHRlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9zdGF0dXMtZmlsdGVyLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBTdGF0dXNGaWx0ZXJDb21wb25lbnQge1xuICBzdGF0dXNPcHRpb25zOiBBcnJheTx7IHNlbGVjdGVkOiBib29sZWFuOyBvcHRpb246IElTdGF0dXNPcHRpb24gfT4gPSBbXTtcblxuICAvKiogTGlzdCBvZiBmaWx0ZXIgb3B0aW9ucyB0byBiZSBkaXNwbGF5ZWQgKi9cbiAgQElucHV0KCkgc2V0IG9wdGlvbnMob3B0aW9uczogSVN0YXR1c09wdGlvbltdKSB7XG4gICAgdGhpcy5zdGF0dXNPcHRpb25zID0gKG9wdGlvbnMgfHwgW10pLm1hcChvcHRpb24gPT4gKHsgc2VsZWN0ZWQ6IGZhbHNlLCBvcHRpb24gfSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFsbG93cyBtdWx0aXBsZSBvcHRpb25zIHRvIGJlIGFjdGl2ZSBzaW11bHRhbmVvc2x5LlxuICAgKi9cbiAgQElucHV0KCdtdWx0aXBsZScpIHNldCBfbXVsdGlwbGUobXVsdGlwbGU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLm11bHRpcGxlID0gY29lcmNlQm9vbGVhblByb3BlcnR5KG11bHRpcGxlKTtcbiAgfVxuXG4gIC8qKiBEaXNwbGF5IHRoZSBmaWx0ZXIgYXMgYSBzbWFsbCBidXR0b24gZ3JvdXAgKi9cbiAgQElucHV0KCdzbWFsbCcpIHNldCBfc21hbGwoc21hbGw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnNtYWxsID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHNtYWxsKTtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuYnRuLWdyb3VwLXNtJykgZ2V0IGRpc3BsYXlTbWFsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5zbWFsbDtcbiAgfVxuXG4gIEBPdXRwdXQoKSBvbkZpbHRlckNoYW5nZWQ6IEV2ZW50RW1pdHRlcjxJU3RhdHVzT3B0aW9uW10+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIGlzQWxsQnV0dG9uU2VsZWN0ZWQ6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIHByaXZhdGUgbXVsdGlwbGU6IGJvb2xlYW47XG4gIHByaXZhdGUgc21hbGw6IGJvb2xlYW47XG5cbiAgY2hhbmdlRmlsdGVyKG9wdGlvbjogeyBzZWxlY3RlZDogYm9vbGVhbjsgb3B0aW9uOiBJU3RhdHVzT3B0aW9uIH0pIHtcbiAgICB0aGlzLmlzQWxsQnV0dG9uU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICBsZXQgZW1pdE5lZWRlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMubXVsdGlwbGUpIHtcbiAgICAgIG9wdGlvbi5zZWxlY3RlZCA9ICFvcHRpb24uc2VsZWN0ZWQ7XG4gICAgICBlbWl0TmVlZGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKCFvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICB0aGlzLnN0YXR1c09wdGlvbnMuZmlsdGVyKG9wID0+IG9wICE9PSBvcHRpb24pLmZvckVhY2gob3AgPT4gKG9wLnNlbGVjdGVkID0gZmFsc2UpKTtcbiAgICAgIGVtaXROZWVkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChlbWl0TmVlZGVkKSB7XG4gICAgICB0aGlzLmVtaXRTZWxlY3RlZE9wdGlvbnMoKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVGaWx0ZXIoKSB7XG4gICAgdGhpcy5pc0FsbEJ1dHRvblNlbGVjdGVkID0gdHJ1ZTtcbiAgICB0aGlzLnN0YXR1c09wdGlvbnMuZm9yRWFjaChvcCA9PiAob3Auc2VsZWN0ZWQgPSBmYWxzZSkpO1xuXG4gICAgdGhpcy5lbWl0U2VsZWN0ZWRPcHRpb25zKCk7XG4gIH1cblxuICAvKipcbiAgICogQWxsb3dzIHRoZSBmaWx0ZXIgdG8gYmUgaW5pdGFsbGl5IGRpc3BsYXllZCB3aXRoIHNvbWUgcHJlc2V0IGZpbHRlcnMuXG4gICAqXG4gICAqIEBwYXJhbSBmaWx0ZXJzIEFuIGBJU3RhdHVzT3B0aW9uYCBhcnJheSBkZWZpbmluZyBmaWx0ZXIgb3B0aW9ucyB0byBiZSBwcmVzZXQuXG4gICAqIEBwYXJhbSBlbWl0ICAob3B0aW9uYWwpIElmIGB0cnVlYCBjb21wb25lbnQgd2lsbCBlbWl0IGBvbkZpbHRlckNoYW5nZWRgIGV2ZW50LlxuICAgKi9cbiAgcHJlc2V0KGZpbHRlcnM6IElTdGF0dXNPcHRpb25bXSwgZW1pdDogYm9vbGVhbiA9IHRydWUpIHtcbiAgICBsZXQgZmlyc3RTZWxlY3RlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgdGhpcy5zdGF0dXNPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IChvcHRpb24uc2VsZWN0ZWQgPSBmYWxzZSkpO1xuXG4gICAgdGhpcy5zdGF0dXNPcHRpb25zXG4gICAgICAuZmlsdGVyKG9wdGlvbiA9PiAoZmlsdGVycyB8fCBbXSkubWFwKG8gPT4gby5sYWJlbCkuaW5jbHVkZXMob3B0aW9uLm9wdGlvbi5sYWJlbCkpXG4gICAgICAuZmlsdGVyKCgpID0+IHtcbiAgICAgICAgLy8gb25seSBmaXJzdCBvcHRpb24gcGFzc2VkIHdpbGwgYmUgc2V0IGluIHNpbmdsZSBzZWxlY3Rpb24gbW9kZVxuICAgICAgICBjb25zdCBpbmNsdWRlOiBib29sZWFuID0gdGhpcy5tdWx0aXBsZSB8fCAhZmlyc3RTZWxlY3RlZDtcbiAgICAgICAgaWYgKGluY2x1ZGUpIHtcbiAgICAgICAgICBmaXJzdFNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpbmNsdWRlO1xuICAgICAgfSlcbiAgICAgIC5mb3JFYWNoKG9wdGlvbiA9PiAob3B0aW9uLnNlbGVjdGVkID0gdHJ1ZSkpO1xuXG4gICAgdGhpcy5pc0FsbEJ1dHRvblNlbGVjdGVkID0gIShmaWx0ZXJzICYmIGZpbHRlcnMubGVuZ3RoKTtcblxuICAgIGlmIChlbWl0KSB7XG4gICAgICB0aGlzLmVtaXRTZWxlY3RlZE9wdGlvbnMoKTtcbiAgICB9XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLnJlbW92ZUZpbHRlcigpO1xuICB9XG5cbiAgYWN0aXZlRmlsdGVycygpOiBJU3RhdHVzT3B0aW9uW10ge1xuICAgIHJldHVybiB0aGlzLnN0YXR1c09wdGlvbnMuZmlsdGVyKG9wdGlvbiA9PiBvcHRpb24uc2VsZWN0ZWQpLm1hcChvcHRpb24gPT4gb3B0aW9uLm9wdGlvbik7XG4gIH1cblxuICBpc0ZpbHRlckFwcGxpZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzT3B0aW9ucy5zb21lKG9wdGlvbiA9PiBvcHRpb24uc2VsZWN0ZWQpO1xuICB9XG5cbiAgcHJpdmF0ZSBlbWl0U2VsZWN0ZWRPcHRpb25zKCkge1xuICAgIHRoaXMub25GaWx0ZXJDaGFuZ2VkLmVtaXQoXG4gICAgICB0aGlzLnN0YXR1c09wdGlvbnMuZmlsdGVyKG9wdGlvbiA9PiBvcHRpb24uc2VsZWN0ZWQpLm1hcChvcHRpb24gPT4gb3B0aW9uLm9wdGlvbilcbiAgICApO1xuICB9XG59XG4iXX0=