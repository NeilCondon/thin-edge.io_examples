import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { ApplicationService } from '@c8y/client';
import { Permissions } from '@c8y/ngx-components';
var SimGuard = /** @class */ (function () {
    function SimGuard(permissions, applicationService) {
        this.permissions = permissions;
        this.applicationService = applicationService;
    }
    SimGuard_1 = SimGuard;
    SimGuard.prototype.canActivate = function (route, state) {
        var _this = this;
        if (this.showSimProvider === undefined) {
            var hasRole = Promise.resolve(this.permissions.hasRole('ROLE_CONNECTIVITY_READ'));
            this.showSimProvider = hasRole.then(function (hasPermissions) {
                return hasPermissions &&
                    _this.applicationService
                        .isAvailable(SimGuard_1.applicationName)
                        .then(function (result) { return result && result.data; });
            });
        }
        return this.showSimProvider;
    };
    var SimGuard_1;
    SimGuard.applicationName = 'connectivity';
    SimGuard.ctorParameters = function () { return [
        { type: Permissions },
        { type: ApplicationService }
    ]; };
    SimGuard = SimGuard_1 = tslib_1.__decorate([
        Injectable()
    ], SimGuard);
    return SimGuard;
}());
export { SimGuard };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltLmd1YXJkLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy9jb25uZWN0aXZpdHkvIiwic291cmNlcyI6WyJzaW0vc2ltLmd1YXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTNDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUNqRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFHbEQ7SUFJRSxrQkFBb0IsV0FBd0IsRUFBVSxrQkFBc0M7UUFBeEUsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFBVSx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO0lBQUcsQ0FBQztpQkFKckYsUUFBUTtJQU1uQiw4QkFBVyxHQUFYLFVBQVksS0FBNkIsRUFBRSxLQUEwQjtRQUFyRSxpQkFnQkM7UUFmQyxJQUFJLElBQUksQ0FBQyxlQUFlLEtBQUssU0FBUyxFQUFFO1lBQ3RDLElBQU0sT0FBTyxHQUFxQixPQUFPLENBQUMsT0FBTyxDQUMvQyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUNuRCxDQUFDO1lBRUYsSUFBSSxDQUFDLGVBQWUsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUNqQyxVQUFDLGNBQXVCO2dCQUN0QixPQUFBLGNBQWM7b0JBQ2QsS0FBSSxDQUFDLGtCQUFrQjt5QkFDcEIsV0FBVyxDQUFDLFVBQVEsQ0FBQyxlQUFlLENBQUM7eUJBQ3JDLElBQUksQ0FBQyxVQUFBLE1BQU0sSUFBSSxPQUFBLE1BQU0sSUFBSSxNQUFNLENBQUMsSUFBSSxFQUFyQixDQUFxQixDQUFDO1lBSHhDLENBR3dDLENBQzNDLENBQUM7U0FDSDtRQUVELE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUM5QixDQUFDOztJQXJCdUIsd0JBQWUsR0FBRyxjQUFjLENBQUM7O2dCQUd4QixXQUFXO2dCQUE4QixrQkFBa0I7O0lBSmpGLFFBQVE7UUFEcEIsVUFBVSxFQUFFO09BQ0EsUUFBUSxDQXVCcEI7SUFBRCxlQUFDO0NBQUEsQUF2QkQsSUF1QkM7U0F2QlksUUFBUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIENhbkFjdGl2YXRlLCBSb3V0ZXJTdGF0ZVNuYXBzaG90IH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IEFwcGxpY2F0aW9uU2VydmljZSB9IGZyb20gJ0BjOHkvY2xpZW50JztcbmltcG9ydCB7IFBlcm1pc3Npb25zIH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cyc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBTaW1HdWFyZCBpbXBsZW1lbnRzIENhbkFjdGl2YXRlIHtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgYXBwbGljYXRpb25OYW1lID0gJ2Nvbm5lY3Rpdml0eSc7XG4gIHByaXZhdGUgc2hvd1NpbVByb3ZpZGVyOiBQcm9taXNlPGJvb2xlYW4+O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcGVybWlzc2lvbnM6IFBlcm1pc3Npb25zLCBwcml2YXRlIGFwcGxpY2F0aW9uU2VydmljZTogQXBwbGljYXRpb25TZXJ2aWNlKSB7fVxuXG4gIGNhbkFjdGl2YXRlKHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LCBzdGF0ZTogUm91dGVyU3RhdGVTbmFwc2hvdCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICh0aGlzLnNob3dTaW1Qcm92aWRlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBoYXNSb2xlOiBQcm9taXNlPGJvb2xlYW4+ID0gUHJvbWlzZS5yZXNvbHZlKFxuICAgICAgICB0aGlzLnBlcm1pc3Npb25zLmhhc1JvbGUoJ1JPTEVfQ09OTkVDVElWSVRZX1JFQUQnKVxuICAgICAgKTtcblxuICAgICAgdGhpcy5zaG93U2ltUHJvdmlkZXIgPSBoYXNSb2xlLnRoZW4oXG4gICAgICAgIChoYXNQZXJtaXNzaW9uczogYm9vbGVhbikgPT5cbiAgICAgICAgICBoYXNQZXJtaXNzaW9ucyAmJlxuICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25TZXJ2aWNlXG4gICAgICAgICAgICAuaXNBdmFpbGFibGUoU2ltR3VhcmQuYXBwbGljYXRpb25OYW1lKVxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHJlc3VsdCAmJiByZXN1bHQuZGF0YSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc2hvd1NpbVByb3ZpZGVyO1xuICB9XG59XG4iXX0=