import * as tslib_1 from "tslib";
import { Component, Input } from '@angular/core';
import { gettext } from '@c8y/ngx-components';
import { has, uniq } from 'lodash-es';
var ConfirmSoftwareSelectionStepComponent = /** @class */ (function () {
    function ConfirmSoftwareSelectionStepComponent() {
    }
    ConfirmSoftwareSelectionStepComponent.prototype.ngOnChanges = function (changes) {
        if (changes.selectedItems) {
            var deviceTypes = this.deviceTypes;
            this.title = deviceTypes && deviceTypes.length ? deviceTypes.join(', ') : gettext('Undefined`device type`');
        }
    };
    Object.defineProperty(ConfirmSoftwareSelectionStepComponent.prototype, "selectedToInstall", {
        get: function () {
            return this.selectedItems.filter(function (software) { return software.action === 'install'; });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ConfirmSoftwareSelectionStepComponent.prototype, "selectedToDelete", {
        get: function () {
            return this.selectedItems.filter(function (software) { return software.action === 'delete'; });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ConfirmSoftwareSelectionStepComponent.prototype, "deviceTypes", {
        get: function () {
            return uniq(this.selectedItems
                .filter(function (val) { return has(val, ['software', 'c8y_Filter', 'type']); })
                .map(function (val) { return val.software.c8y_Filter.type; }));
        },
        enumerable: true,
        configurable: true
    });
    tslib_1.__decorate([
        Input()
    ], ConfirmSoftwareSelectionStepComponent.prototype, "selectedItems", void 0);
    ConfirmSoftwareSelectionStepComponent = tslib_1.__decorate([
        Component({
            selector: 'c8y-confirm-software-selection-step',
            template: "<div class=\"card-block p-t-0 flex-no-shrink separator-bottom col-xs-12\">\n  <div class=\"row p-b-16\">\n    <div class=\"col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4\">\n      <h4 class=\"text-center text-gray\">{{ 'Confirm selection' | translate }}</h4>\n    </div>\n  </div>\n</div>\n<div class=\"col-xs-12 flex-grow no-gutter\">\n  <div class=\"card-inner-scroll fit-h\">\n    <div class=\"card-block\">\n      <div class=\"row p-b-16\">\n        <div class=\"col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4\">\n          <div class=\"text-truncate\" title=\"{{ this.title }}\">\n            <span class=\"legend form-block\" translate>Device type</span>\n            <ng-container *ngIf=\"deviceTypes.length > 0; else noType\">\n              <span *ngFor=\"let deviceType of deviceTypes; let last = last\">{{ deviceType }}{{ last ? '' : ', ' }}</span>\n            </ng-container>\n            <ng-template #noType>\n              <em class=\"text-muted\" translate>Undefined`device type`</em>\n            </ng-template>\n          </div>\n        </div>\n      </div>\n      <div class=\"row p-b-16\" *ngIf=\"selectedToInstall.length\">\n        <div class=\"col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4\">\n          <span class=\"legend form-block\" translate>Installations/updates`software`</span>\n          <c8y-list-group>\n            <c8y-li *ngFor=\"let selectedItem of selectedToInstall\">\n              <c8y-li-icon>\n                <i c8yIcon=\"c8y-tools\"></i>\n              </c8y-li-icon>\n              <c8y-li-body class=\"content-flex-10\">\n                <div class=\"col-6 text-truncate\" title=\"{{ selectedItem.software.name }}\">\n                  {{ selectedItem.software.name }}\n                </div>\n                <div class=\"col-6 text-right\">\n                  <span class=\"text-label-small m-r-4\" translate>\n                    Version\n                  </span>\n                  <span>\n                    {{ selectedItem.version.c8y_Software.version }}\n                  </span>\n                </div>\n              </c8y-li-body>\n            </c8y-li>\n          </c8y-list-group>\n        </div>\n      </div>\n      <div class=\"row p-b-16\" *ngIf=\"selectedToDelete.length\">\n        <div class=\"col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4\">\n          <span class=\"legend form-block\" translate>Removals`software`</span>\n          <c8y-list-group>\n            <c8y-li *ngFor=\"let selectedItem of selectedToDelete\">\n              <c8y-li-icon>\n                <i c8yIcon=\"c8y-tools\"></i>\n              </c8y-li-icon>\n              <c8y-li-body class=\"content-flex-10\">\n                <div class=\"col-6\">\n                  {{ selectedItem.software.name }}\n                </div>\n                <div class=\"col-6 text-right\">\n                  <span class=\"text-label-small m-r-8\" translate>\n                    Version\n                  </span>\n                  <span>\n                    {{ selectedItem.version.c8y_Software.version }}\n                  </span>\n                </div>\n              </c8y-li-body>\n            </c8y-li>\n          </c8y-list-group>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"
        })
    ], ConfirmSoftwareSelectionStepComponent);
    return ConfirmSoftwareSelectionStepComponent;
}());
export { ConfirmSoftwareSelectionStepComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlybS1zb2Z0d2FyZS1zZWxlY3Rpb24tc3RlcC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYzh5L25neC1jb21wb25lbnRzL29wZXJhdGlvbnMvc3RlcHBlci1idWxrLXR5cGUtc29mdHdhcmUvIiwic291cmNlcyI6WyJjb25maXJtLXNvZnR3YXJlLXNlbGVjdGlvbi1zdGVwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBQzNFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUM5QyxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLFdBQVcsQ0FBQztBQU90QztJQUFBO0lBMEJBLENBQUM7SUF0QkMsMkRBQVcsR0FBWCxVQUFZLE9BQXNCO1FBQ2hDLElBQUksT0FBTyxDQUFDLGFBQWEsRUFBRTtZQUN6QixJQUFNLFdBQVcsR0FBYSxJQUFJLENBQUMsV0FBVyxDQUFDO1lBQy9DLElBQUksQ0FBQyxLQUFLLEdBQUcsV0FBVyxJQUFJLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1NBQzdHO0lBQ0gsQ0FBQztJQUVELHNCQUFJLG9FQUFpQjthQUFyQjtZQUNFLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsVUFBQSxRQUFRLElBQUksT0FBQSxRQUFRLENBQUMsTUFBTSxLQUFLLFNBQVMsRUFBN0IsQ0FBNkIsQ0FBQyxDQUFDO1FBQzlFLENBQUM7OztPQUFBO0lBRUQsc0JBQUksbUVBQWdCO2FBQXBCO1lBQ0UsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxVQUFBLFFBQVEsSUFBSSxPQUFBLFFBQVEsQ0FBQyxNQUFNLEtBQUssUUFBUSxFQUE1QixDQUE0QixDQUFDLENBQUM7UUFDN0UsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSw4REFBVzthQUFmO1lBQ0UsT0FBTyxJQUFJLENBQ1QsSUFBSSxDQUFDLGFBQWE7aUJBQ2YsTUFBTSxDQUFDLFVBQUEsR0FBRyxJQUFJLE9BQUEsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVUsRUFBRSxZQUFZLEVBQUUsTUFBTSxDQUFDLENBQUMsRUFBNUMsQ0FBNEMsQ0FBQztpQkFDM0QsR0FBRyxDQUFDLFVBQUEsR0FBRyxJQUFJLE9BQUEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUE1QixDQUE0QixDQUFDLENBQzVDLENBQUM7UUFDSixDQUFDOzs7T0FBQTtJQXhCUTtRQUFSLEtBQUssRUFBRTtnRkFBb0M7SUFEakMscUNBQXFDO1FBSmpELFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxxQ0FBcUM7WUFDL0MsNnJHQUE2RDtTQUM5RCxDQUFDO09BQ1cscUNBQXFDLENBMEJqRDtJQUFELDRDQUFDO0NBQUEsQUExQkQsSUEwQkM7U0ExQlkscUNBQXFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBnZXR0ZXh0IH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cyc7XG5pbXBvcnQgeyBoYXMsIHVuaXEgfSBmcm9tICdsb2Rhc2gtZXMnO1xuaW1wb3J0IHsgSVNlbGVjdGVkU29mdHdhcmUgfSBmcm9tICcuL3NlbGVjdC1zb2Z0d2FyZS5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2M4eS1jb25maXJtLXNvZnR3YXJlLXNlbGVjdGlvbi1zdGVwJyxcbiAgdGVtcGxhdGVVcmw6ICdjb25maXJtLXNvZnR3YXJlLXNlbGVjdGlvbi1zdGVwLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBDb25maXJtU29mdHdhcmVTZWxlY3Rpb25TdGVwQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcbiAgQElucHV0KCkgc2VsZWN0ZWRJdGVtczogSVNlbGVjdGVkU29mdHdhcmVbXTtcbiAgdGl0bGU6IHN0cmluZztcblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgaWYgKGNoYW5nZXMuc2VsZWN0ZWRJdGVtcykge1xuICAgICAgY29uc3QgZGV2aWNlVHlwZXM6IHN0cmluZ1tdID0gdGhpcy5kZXZpY2VUeXBlcztcbiAgICAgIHRoaXMudGl0bGUgPSBkZXZpY2VUeXBlcyAmJiBkZXZpY2VUeXBlcy5sZW5ndGggPyBkZXZpY2VUeXBlcy5qb2luKCcsICcpIDogZ2V0dGV4dCgnVW5kZWZpbmVkYGRldmljZSB0eXBlYCcpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzZWxlY3RlZFRvSW5zdGFsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEl0ZW1zLmZpbHRlcihzb2Z0d2FyZSA9PiBzb2Z0d2FyZS5hY3Rpb24gPT09ICdpbnN0YWxsJyk7XG4gIH1cblxuICBnZXQgc2VsZWN0ZWRUb0RlbGV0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEl0ZW1zLmZpbHRlcihzb2Z0d2FyZSA9PiBzb2Z0d2FyZS5hY3Rpb24gPT09ICdkZWxldGUnKTtcbiAgfVxuXG4gIGdldCBkZXZpY2VUeXBlcygpIHtcbiAgICByZXR1cm4gdW5pcShcbiAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtc1xuICAgICAgICAuZmlsdGVyKHZhbCA9PiBoYXModmFsLCBbJ3NvZnR3YXJlJywgJ2M4eV9GaWx0ZXInLCAndHlwZSddKSlcbiAgICAgICAgLm1hcCh2YWwgPT4gdmFsLnNvZnR3YXJlLmM4eV9GaWx0ZXIudHlwZSlcbiAgICApO1xuICB9XG59XG4iXX0=